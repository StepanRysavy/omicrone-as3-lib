package com.omicrone{	import flash.utils.setTimeout;				import be.wellconsidered.apis.fbbridge.data.FBBridgeUser;	import be.wellconsidered.apis.fbbridge.data.FBBridgePermissions;	import be.wellconsidered.apis.fbbridge.events.FBBridgeEvent;	import be.wellconsidered.apis.fbbridge.FBBridge;				public class FBConnector	{		public function FBConnector(cb:Function, rp:Function)		{			fceCallbackTexts = cb;			fceCallbackReadPhoto = rp;			 init();		}		private var _fbBridge:FBBridge;					private function init():void		{			setTimeout(initBridge, 5000);		}		public var fceCallbackTexts:Function = null;		public var fceCallbackReadPhoto:Function = null;		private function initBridge():void		{			_fbBridge = new FBBridge();			fceCallbackTexts("inicializuji...");						_fbBridge.login();						_fbBridge.addEventListener(FBBridgeEvent.LOGGED_IN, onLoggedIn);		}					private function onLoggedIn(e:FBBridgeEvent):void		{			/*_fbBridge.addEventListener(FBBridgeEvent.USER_INFO, onUserInfo);			_fbBridge.getUserInfo();*/			fceCallbackTexts("načítám přátele..");				getFriends();		}					private function onUserInfo(e:FBBridgeEvent):void		{			var uInfo:FBBridgeUser = _fbBridge.user;			//fceCallback(uInfo.name.toString());		}						private function getFriends():void		{			_fbBridge.addEventListener(FBBridgeEvent.FRIENDS_LIST, onFriendsList);			_fbBridge.getFriendsList();		}					private function onFriendsList(e:FBBridgeEvent):void		{			var arrFriends:Array = e.data as Array;								fceCallbackTexts("Načteno " + arrFriends.length.toString() + " přátel..");							_fbBridge.removeEventListener(FBBridgeEvent.FRIENDS_LIST, onFriendsList);							_fbBridge.addEventListener(FBBridgeEvent.USERS_INFO, onUsersInfo);			_fbBridge.getUsersInfo(arrFriends, ["uid", "pic_big", "first_name", "last_name", "about_me", "sex", "name", "proxied_email"]);		}					private function onUsersInfo(e:FBBridgeEvent):void		{			_fbBridge.removeEventListener(FBBridgeEvent.USERS_INFO, onUsersInfo);			fceCallbackTexts("načítám fotografie..");			var arrFriends:Array = e.data as Array;			var xml:String = "<?xml version='1.0'?>";			xml+="<photos>";									for(var i:int = 0; i < arrFriends.length; i++)			{				var oFriend:Object = arrFriends[i];				xml+="<photo src='" + oFriend.pic_big + "' uid='" + oFriend.uid + "' />";								//fceCallbackTexts(oFriend.last_name + " - " + oFriend.uid);			}			xml+="</photos>";			fceCallbackReadPhoto(xml);		}	}}